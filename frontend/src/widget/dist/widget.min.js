/*! For license information please see widget.min.js.LICENSE.txt */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.SBTCPayWidget=n():t.SBTCPayWidget=n()}(this,()=>{return t={592:t=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function e(){var t,n,a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function s(e,a,r,i){var s=a&&a.prototype instanceof l?a:l,d=Object.create(s.prototype);return o(d,"_invoke",function(e,o,a){var r,i,s,l=0,d=a||[],p=!1,u={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return r=n,i=0,s=t,u.n=e,c}};function y(e,o){for(i=e,s=o,n=0;!p&&l&&!a&&n<d.length;n++){var a,r=d[n],y=u.p,h=r[2];e>3?(a=h===o)&&(s=r[(i=r[4])?5:(i=3,3)],r[4]=r[5]=t):r[0]<=y&&((a=e<2&&y<r[1])?(i=0,u.v=o,u.n=r[1]):y<h&&(a=e<3||r[0]>o||o>h)&&(r[4]=e,r[5]=o,u.n=h,i=0))}if(a||e>1)return c;throw p=!0,o}return function(a,d,h){if(l>1)throw TypeError("Generator is already running");for(p&&1===d&&y(d,h),i=d,s=h;(n=i<2?t:s)||!p;){r||(i?i<3?(i>1&&(u.n=-1),y(i,s)):u.n=s:u.v=s);try{if(l=2,r){if(i||(a="next"),n=r[a]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,i<2&&(i=0)}else 1===i&&(n=r.return)&&n.call(r),i<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),i=1);r=t}else if((n=(p=u.n<0)?s:e.call(o,u))!==c)break}catch(n){r=t,i=1,s=n}finally{l=1}}return{value:n,done:p}}}(e,r,i),!0),d}var c={};function l(){}function d(){}function p(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(o(n={},r,function(){return this}),n),y=p.prototype=l.prototype=Object.create(u);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,o(t,i,"GeneratorFunction")),t.prototype=Object.create(y),t}return d.prototype=p,o(y,"constructor",p),o(p,"constructor",d),d.displayName="GeneratorFunction",o(p,i,"GeneratorFunction"),o(y),o(y,i,"Generator"),o(y,r,function(){return this}),o(y,"toString",function(){return"[object Generator]"}),(e=function(){return{w:s,m:h}})()}function o(t,n,e,a){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}o=function(t,n,e,a){function i(n,e){o(t,n,function(t){return this._invoke(n,e,t)})}n?r?r(t,n,{value:e,enumerable:!a,configurable:!a,writable:!a}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},o(t,n,e,a)}function a(t,n,e,o,a,r,i){try{var s=t[r](i),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(o,a)}function r(t){return function(){var n=this,e=arguments;return new Promise(function(o,r){var i=t.apply(n,e);function s(t){a(i,o,r,s,c,"next",t)}function c(t){a(i,o,r,s,c,"throw",t)}s(void 0)})}}function i(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,o)}return e}function s(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?i(Object(e),!0).forEach(function(n){c(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function c(t,n,e){return(n=d(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function l(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,d(o.key),o)}}function d(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var o=e.call(t,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}var p=function(){return t=function t(){var n,e,o,a,r,i,c=this,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=s({apiKey:l.apiKey||null,paymentIntentId:l.paymentIntentId||null,baseUrl:l.baseUrl||"http://localhost:3000/api/v1",container:l.container||null,enabledWallets:l.enabledWallets||["leather","xverse","unisat","okx"],theme:{primaryColor:(null===(n=l.theme)||void 0===n?void 0:n.primaryColor)||"#3498db",backgroundColor:(null===(e=l.theme)||void 0===e?void 0:e.backgroundColor)||"#ffffff",textColor:(null===(o=l.theme)||void 0===o?void 0:o.textColor)||"#333333",fontFamily:(null===(a=l.theme)||void 0===a?void 0:a.fontFamily)||"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif",borderRadius:(null===(r=l.theme)||void 0===r?void 0:r.borderRadius)||"8px",logoUrl:(null===(i=l.theme)||void 0===i?void 0:i.logoUrl)||null},lang:l.lang||"en",showQRCode:!1!==l.showQRCode,enablePolling:!1!==l.enablePolling,pollingInterval:l.pollingInterval||5e3},l),this.container=null,this.paymentData=null,this.connectedWallet=null,this.userAddress=null,this.pollingTimer=null,this.qrCodeGenerated=!1,this.availableWallets=this.detectWallets(),this.options.paymentIntentId&&setTimeout(function(){c.init()},0)},n=[{key:"init",value:(b=r(e().m(function t(){var n;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.fetchPaymentIntent();case 1:this.render(),t.n=3;break;case 2:t.p=2,n=t.v,console.error("Failed to initialize widget:",n),this.renderError("Failed to load payment information");case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return b.apply(this,arguments)})},{key:"detectWallets",value:function(){var t=[];if("undefined"!=typeof window)try{(window.StacksProvider||window.btc)&&t.push({id:"leather",name:"Leather",icon:"https://leather.io/icons/leather-icon.svg",provider:"stacks-connect",supported:["stacks","bitcoin"]}),(window.XverseProviders||window.BitcoinProvider)&&t.push({id:"xverse",name:"Xverse",icon:"https://xverse.app/favicon.ico",provider:"sats-connect",supported:["bitcoin","stacks","ordinals"]}),window.unisat&&t.push({id:"unisat",name:"Unisat",icon:"https://unisat.io/favicon.ico",provider:"unisat",supported:["bitcoin","ordinals"]}),window.okxwallet&&t.push({id:"okx",name:"OKX Wallet",icon:"https://www.okx.com/favicon.ico",provider:"okx",supported:["bitcoin","stacks"]})}catch(t){console.warn("Error detecting wallets:",t)}return t}},{key:"fetchPaymentIntent",value:(f=r(e().m(function t(){var n;return e().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("".concat(this.options.baseUrl,"/payment-intents/").concat(this.options.paymentIntentId),{headers:s({"Content-Type":"application/json"},this.options.apiKey&&{Authorization:"Bearer ".concat(this.options.apiKey)})});case 1:if((n=t.v).ok){t.n=2;break}throw new Error("Failed to fetch payment intent: ".concat(n.status));case 2:return t.n=3,n.json();case 3:this.paymentData=t.v;case 4:return t.a(2)}},t,this)})),function(){return f.apply(this,arguments)})},{key:"render",value:function(){if(this.container=document.createElement("div"),this.container.className="sbtcpay-widget",this.container.innerHTML=this.getWidgetHTML(),this.attachEventListeners(),this.injectStyles(),this.options.container){var t=document.querySelector(this.options.container);t&&t.appendChild(this.container)}else document.body.appendChild(this.container)}},{key:"renderError",value:function(t){var n='\n      <div class="sbtcpay-widget-error">\n        <div class="sbtcpay-widget-error-content">\n          <h3>Error</h3>\n          <p>'.concat(t,"</p>\n        </div>\n      </div>\n    ");if(this.options.container){var e=document.querySelector(this.options.container);e&&(e.innerHTML=n)}else document.body.insertAdjacentHTML("beforeend",n)}},{key:"getWidgetHTML",value:function(){if(!this.paymentData)return"";var t=this.options.theme.logoUrl?'<div class="sbtcpay-widget-logo"><img src="'.concat(this.options.theme.logoUrl,'" alt="Merchant Logo" /></div>'):"";return this.getWalletSelectionHTML(),'\n      <div class="sbtcpay-widget-container">\n        <div class="sbtcpay-widget-header">\n          '.concat(t,'\n          <h3>Complete Your Payment</h3>\n        </div>\n        <div class="sbtcpay-widget-body">\n          <div class="sbtcpay-widget-payment-info">\n            <div class="sbtcpay-widget-amount">\n              <span class="label">Amount:</span>\n              <span class="value">').concat(this.paymentData.amount,' sBTC</span>\n            </div>\n            <div class="sbtcpay-widget-description">\n              <span class="label">Description:</span>\n              <span class="value">').concat(this.paymentData.description||"Payment","</span>\n            </div>\n          </div>\n          \n          ").concat(this.connectedWallet?this.getConnectedWalletHTML():this.getWalletSelectionHTML(),'\n          \n          <div class="sbtcpay-widget-qrcode" id="sbtcpay-qrcode-container" style="display: none;">\n            <h4>Scan with your mobile wallet</h4>\n            <div id="sbtcpay-qrcode"></div>\n            <div class="sbtcpay-payment-address" id="sbtcpay-payment-address"></div>\n          </div>\n          \n          <div class="sbtcpay-widget-status" id="sbtcpay-status"></div>\n        </div>\n        <div class="sbtcpay-widget-footer">\n          <p>Powered by sBTCPay</p>\n        </div>\n      </div>\n    ')}},{key:"getWalletSelectionHTML",value:function(){var t=this;if(0===this.availableWallets.length)return'\n        <div class="sbtcpay-no-wallets">\n          <p>No compatible wallets detected. Please install:</p>\n          <div class="sbtcpay-wallet-recommendations">\n            <a href="https://leather.io" target="_blank" rel="noopener">Leather Wallet</a>\n            <a href="https://xverse.app" target="_blank" rel="noopener">Xverse Wallet</a>\n            <a href="https://unisat.io" target="_blank" rel="noopener">Unisat Wallet</a>\n          </div>\n        </div>\n      ';var n=this.availableWallets.filter(function(n){return t.options.enabledWallets.includes(n.id)}).map(function(t){return'\n        <button class="sbtcpay-wallet-button" data-wallet-id="'.concat(t.id,'">\n          <img src="').concat(t.icon,'" alt="').concat(t.name,'" class="wallet-icon" onerror="this.style.display=\'none\'" />\n          <span>Connect ').concat(t.name,"</span>\n        </button>\n      ")}).join("");return'\n      <div class="sbtcpay-wallet-selection">\n        <h4>Choose your wallet:</h4>\n        <div class="sbtcpay-wallet-buttons">\n          '.concat(n,"\n        </div>\n        ").concat(this.options.showQRCode?'<p class="sbtcpay-or-text">or</p>':"","\n        ").concat(this.options.showQRCode?'<button id="sbtcpay-show-qr-button" class="sbtcpay-secondary-button">Show QR Code</button>':"","\n      </div>\n    ")}},{key:"getConnectedWalletHTML",value:function(){return'\n      <div class="sbtcpay-connected-wallet">\n        <div class="sbtcpay-wallet-info">\n          <span class="wallet-name">Connected: '.concat(this.connectedWallet.name,'</span>\n          <span class="wallet-address">').concat(this.formatAddress(this.userAddress),'</span>\n        </div>\n        <div class="sbtcpay-widget-actions">\n          <button id="sbtcpay-pay-button" class="sbtcpay-button">Pay with sBTC</button>\n          <button id="sbtcpay-disconnect-button" class="sbtcpay-secondary-button">Disconnect</button>\n        </div>\n      </div>\n    ')}},{key:"formatAddress",value:function(t){return t?t.length<=16?t:"".concat(t.slice(0,8),"...").concat(t.slice(-8)):""}},{key:"attachEventListeners",value:function(){var t=this;this.container.querySelectorAll(".sbtcpay-wallet-button").forEach(function(n){n.addEventListener("click",function(){var e=n.dataset.walletId;t.connectWallet(e)})});var n=this.container.querySelector("#sbtcpay-show-qr-button");n&&n.addEventListener("click",function(){t.showQRCode()});var e=this.container.querySelector("#sbtcpay-pay-button");e&&e.addEventListener("click",function(){t.handlePayment()});var o=this.container.querySelector("#sbtcpay-disconnect-button");o&&o.addEventListener("click",function(){t.disconnectWallet()})}},{key:"connectWallet",value:(h=r(e().m(function t(n){var o,a,r,i;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.updateStatus("Connecting to wallet..."),t.p=1,o=this.availableWallets.find(function(t){return t.id===n})){t.n=2;break}throw new Error("Wallet ".concat(n," not found"));case 2:r=o.provider,t.n="stacks-connect"===r?3:"sats-connect"===r?5:"unisat"===r?7:"okx"===r?9:11;break;case 3:return t.n=4,this.connectLeatherWallet();case 4:return a=t.v,t.a(3,12);case 5:return t.n=6,this.connectXverseWallet();case 6:return a=t.v,t.a(3,12);case 7:return t.n=8,this.connectUnisatWallet();case 8:return a=t.v,t.a(3,12);case 9:return t.n=10,this.connectOKXWallet();case 10:return a=t.v,t.a(3,12);case 11:throw new Error("Unsupported wallet provider: ".concat(o.provider));case 12:this.connectedWallet=o,this.userAddress=a,this.updateStatus("Wallet connected successfully!"),this.updateDisplay(),this.options.enablePolling&&this.startPaymentPolling(),t.n=14;break;case 13:t.p=13,i=t.v,console.error("Failed to connect wallet:",i),this.updateStatus("Failed to connect: ".concat(i.message));case 14:return t.a(2)}},t,this,[[1,13]])})),function(t){return h.apply(this,arguments)})},{key:"connectLeatherWallet",value:(y=r(e().m(function t(){var n=this;return e().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t,e){try{if("undefined"==typeof showConnect)return void(window.btc&&window.btc.request?window.btc.request("getAddresses").then(function(n){n&&n.addresses&&n.addresses.length>0?t(n.addresses[0]):e(new Error("No addresses returned from Leather wallet"))}).catch(e):e(new Error("Leather wallet not detected")));var o={name:"sBTCPay Widget",icon:n.options.theme.logoUrl||"https://sbtcpay.com/icon.png"};showConnect({appDetails:o,onFinish:function(n){if(n&&n.userSession){var o=n.userSession.loadUserData();t(o.profile.stxAddress.mainnet)}else e(new Error("Authentication failed"))},onCancel:function(){e(new Error("User cancelled wallet connection"))}})}catch(t){e(t)}}))},t)})),function(){return y.apply(this,arguments)})},{key:"connectXverseWallet",value:(u=r(e().m(function t(){var n,o,a,r,i,s;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,"undefined"!=typeof request){t.n=1;break}throw new Error("Sats Connect library not available");case 1:return t.n=2,request("wallet_connect",null);case 2:if("success"!==(n=t.v).status){t.n=4;break}if(o=n.result.addresses,a=o.find(function(t){return"payment"===t.purpose}),r=a||o[0]){t.n=3;break}throw new Error("No addresses returned from Xverse wallet");case 3:return t.a(2,r.address);case 4:throw new Error((null===(i=n.error)||void 0===i?void 0:i.message)||"Failed to connect to Xverse wallet");case 5:t.n=7;break;case 6:throw t.p=6,s=t.v,new Error("Xverse connection failed: ".concat(s.message));case 7:return t.a(2)}},t,null,[[0,6]])})),function(){return u.apply(this,arguments)})},{key:"connectUnisatWallet",value:(p=r(e().m(function t(){var n,o;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,window.unisat){t.n=1;break}throw new Error("Unisat wallet not detected");case 1:return t.n=2,window.unisat.requestAccounts();case 2:if((n=t.v)&&0!==n.length){t.n=3;break}throw new Error("No accounts returned from Unisat wallet");case 3:return t.a(2,n[0]);case 4:throw t.p=4,o=t.v,new Error("Unisat connection failed: ".concat(o.message));case 5:return t.a(2)}},t,null,[[0,4]])})),function(){return p.apply(this,arguments)})},{key:"connectOKXWallet",value:(d=r(e().m(function t(){var n,o;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,window.okxwallet&&window.okxwallet.bitcoin){t.n=1;break}throw new Error("OKX wallet not detected");case 1:return t.n=2,window.okxwallet.bitcoin.connect();case 2:if((n=t.v)&&n.address){t.n=3;break}throw new Error("No address returned from OKX wallet");case 3:return t.a(2,n.address);case 4:throw t.p=4,o=t.v,new Error("OKX connection failed: ".concat(o.message));case 5:return t.a(2)}},t,null,[[0,4]])})),function(){return d.apply(this,arguments)})},{key:"disconnectWallet",value:function(){this.connectedWallet=null,this.userAddress=null,this.pollingTimer&&(clearInterval(this.pollingTimer),this.pollingTimer=null),this.updateStatus("Wallet disconnected"),this.updateDisplay()}},{key:"updateDisplay",value:function(){if(this.container){var t=this.container.querySelector(".sbtcpay-widget-body");if(t){var n=this.getWidgetHTML(),e=document.createElement("div");e.innerHTML=n;var o=e.querySelector(".sbtcpay-widget-body");t.innerHTML=o.innerHTML,this.attachEventListeners()}}else console.warn("Widget container not found, cannot update display")}},{key:"handlePayment",value:(c=r(e().m(function t(){var n,o;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.connectedWallet&&this.userAddress){t.n=1;break}return this.updateStatus("Please connect a wallet first","error"),t.a(2);case 1:return this.updateStatus("Processing payment..."),t.p=2,t.n=3,this.generateQRCode();case 3:(n=this.container.querySelector("#sbtcpay-qrcode-container"))&&(n.style.display="block"),this.updateStatus("Please complete the payment in your wallet"),!this.pollingTimer&&this.options.enablePolling&&this.startPaymentPolling(),t.n=5;break;case 4:t.p=4,o=t.v,console.error("Payment error:",o),this.updateStatus("Payment failed: ".concat(o.message),"error");case 5:return t.a(2)}},t,this,[[2,4]])})),function(){return c.apply(this,arguments)})},{key:"showQRCode",value:(i=r(e().m(function t(){var n,o;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.generateQRCode();case 1:(n=this.container.querySelector("#sbtcpay-qrcode-container"))&&(n.style.display="block"),this.updateStatus("Scan QR code with your mobile wallet"),!this.pollingTimer&&this.options.enablePolling&&this.startPaymentPolling(),t.n=3;break;case 2:t.p=2,o=t.v,console.error("QR code error:",o),this.updateStatus("Failed to generate QR code: ".concat(o.message),"error");case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return i.apply(this,arguments)})},{key:"generateQRCode",value:(a=r(e().m(function t(){var n,o,a,r,i,s,c;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:(n=this.container.querySelector("#sbtcpay-qrcode-container"))&&(o=n.querySelector("#sbtcpay-qrcode"))&&(o.innerHTML=""),t.p=1,a=this.generatePaymentData(),(r=this.container.querySelector("#sbtcpay-payment-address"))&&a.address&&(r.innerHTML='\n          <div class="payment-address-info">\n            <label>Payment Address:</label>\n            <div class="address-text" onclick="navigator.clipboard.writeText(\''.concat(a.address,'\')" title="Click to copy">\n              ').concat(a.address,"\n            </div>\n            <small>Click to copy address</small>\n          </div>\n        ")),"undefined"!=typeof QRCode?(i=this.container.querySelector("#sbtcpay-qrcode"))&&new QRCode(i,{text:a.qrText,width:200,height:200,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel?QRCode.CorrectLevel.H:0}):(s=this.container.querySelector("#sbtcpay-qrcode"))&&(s.innerHTML='\n            <div class="qr-fallback">\n              <p>QR Code Library not loaded</p>\n              <p>Amount: '.concat(this.paymentData.amount," sBTC</p>\n              ").concat(a.address?"<p>To: ".concat(a.address,"</p>"):"","\n            </div>\n          ")),this.qrCodeGenerated=!0,t.n=3;break;case 2:throw t.p=2,c=t.v,console.error("Failed to generate QR code:",c),c;case 3:return t.a(2)}},t,this,[[1,2]])})),function(){return a.apply(this,arguments)})},{key:"generatePaymentData",value:function(){var t="SP1234567890ABCDEF1234567890ABCDEF12345678",n="stacks:".concat(t,"?amount=").concat(this.paymentData.amount,"&memo=").concat(encodeURIComponent(this.paymentData.description||"sBTCPay Payment"));return{address:t,amount:this.paymentData.amount,qrText:n,description:this.paymentData.description}}},{key:"startPaymentPolling",value:function(){var t=this;this.pollingTimer&&clearInterval(this.pollingTimer),this.updateStatus("Waiting for payment confirmation..."),this.pollingTimer=setInterval(r(e().m(function n(){var o,a;return e().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,t.checkPaymentStatus();case 1:(o=n.v).confirmed?t.handlePaymentSuccess(o):o.failed&&t.handlePaymentFailure(o),n.n=3;break;case 2:n.p=2,a=n.v,console.error("Error checking payment status:",a);case 3:return n.a(2)}},n,null,[[0,2]])})),this.options.pollingInterval),setTimeout(function(){t.pollingTimer&&(clearInterval(t.pollingTimer),t.pollingTimer=null,t.updateStatus("Payment timeout. Please try again.","warning"))},6e5)}},{key:"checkPaymentStatus",value:(o=r(e().m(function t(){var n,o;return e().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("".concat(this.options.baseUrl,"/payment-intents/").concat(this.options.paymentIntentId),{headers:s({"Content-Type":"application/json"},this.options.apiKey&&{Authorization:"Bearer ".concat(this.options.apiKey)})});case 1:if((n=t.v).ok){t.n=2;break}throw new Error("Failed to check payment status: ".concat(n.status));case 2:return t.n=3,n.json();case 3:return o=t.v,t.a(2,{confirmed:"succeeded"===o.status,failed:"failed"===o.status||"cancelled"===o.status,pending:"requires_payment"===o.status||"processing"===o.status,data:o})}},t,this)})),function(){return o.apply(this,arguments)})},{key:"handlePaymentSuccess",value:function(t){this.pollingTimer&&(clearInterval(this.pollingTimer),this.pollingTimer=null),this.updateStatus("Payment confirmed! Thank you.","success");var n=this.container.querySelector("#sbtcpay-qrcode-container");n&&(n.style.display="none"),this.showSuccessState(t.data),this.options.onSuccess&&this.options.onSuccess(t.data)}},{key:"handlePaymentFailure",value:function(t){this.pollingTimer&&(clearInterval(this.pollingTimer),this.pollingTimer=null),this.updateStatus("Payment failed. Please try again.","error"),this.options.onFailure&&this.options.onFailure(t.data)}},{key:"showSuccessState",value:function(t){var n=this.container.querySelector(".sbtcpay-widget-body");n&&(n.innerHTML='\n        <div class="sbtcpay-success">\n          <div class="success-icon">✓</div>\n          <h3>Payment Successful!</h3>\n          <p>Amount: '.concat(t.amount," sBTC</p>\n          ").concat(t.stacksTxId?"<p>Transaction ID: ".concat(t.stacksTxId,"</p>"):"","\n          <p>Thank you for your payment.</p>\n        </div>\n      "))}},{key:"updateStatus",value:function(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",o=null===(n=this.container)||void 0===n?void 0:n.querySelector("#sbtcpay-status");o&&(o.innerHTML='<p class="status-'.concat(e,'">').concat(t,"</p>"))}},{key:"injectStyles",value:function(){if(!document.getElementById("sbtcpay-widget-styles")){var t='\n      <style id="sbtcpay-widget-styles">\n        .sbtcpay-widget {\n          font-family: '.concat(this.options.theme.fontFamily,";\n          max-width: 400px;\n          margin: 0 auto;\n          border: 1px solid #e1e5e9;\n          border-radius: ").concat(this.options.theme.borderRadius,";\n          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n          background: ").concat(this.options.theme.backgroundColor,";\n          color: ").concat(this.options.theme.textColor,";\n        }\n        \n        @media (max-width: 480px) {\n          .sbtcpay-widget {\n            max-width: 95%;\n            margin: 0 10px;\n          }\n        }\n        \n        @media (max-width: 768px) {\n          .sbtcpay-widget {\n            max-width: 90%;\n          }\n        }\n        \n        .sbtcpay-widget-container {\n          padding: 20px;\n        }\n        \n        .sbtcpay-widget-logo {\n          text-align: center;\n          margin-bottom: 15px;\n        }\n        \n        .sbtcpay-widget-logo img {\n          max-height: 50px;\n          max-width: 100%;\n        }\n        \n        .sbtcpay-widget-header h3 {\n          margin: 0 0 15px 0;\n          font-size: 1.2em;\n          text-align: center;\n          color: ").concat(this.options.theme.textColor,";\n        }\n        \n        .sbtcpay-widget-payment-info {\n          margin-bottom: 20px;\n        }\n        \n        .sbtcpay-widget-payment-info .label {\n          font-weight: 600;\n          color: #666;\n          margin-right: 10px;\n        }\n        \n        .sbtcpay-widget-payment-info .value {\n          font-weight: bold;\n          color: ").concat(this.options.theme.textColor,";\n        }\n        \n        .sbtcpay-widget-amount,\n        .sbtcpay-widget-description {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 10px;\n        }\n        \n        /* Wallet Selection Styles */\n        .sbtcpay-wallet-selection {\n          margin: 20px 0;\n        }\n        \n        .sbtcpay-wallet-selection h4 {\n          margin: 0 0 15px 0;\n          font-size: 1em;\n          color: ").concat(this.options.theme.textColor,";\n          text-align: center;\n        }\n        \n        .sbtcpay-wallet-buttons {\n          display: flex;\n          flex-direction: column;\n          gap: 10px;\n        }\n        \n        .sbtcpay-wallet-button {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          padding: 12px 16px;\n          border: 2px solid #e1e5e9;\n          border-radius: ").concat(this.options.theme.borderRadius,";\n          background: ").concat(this.options.theme.backgroundColor,";\n          color: ").concat(this.options.theme.textColor,";\n          cursor: pointer;\n          transition: all 0.2s ease;\n          font-size: 14px;\n          font-weight: 500;\n        }\n        \n        .sbtcpay-wallet-button:hover {\n          border-color: ").concat(this.options.theme.primaryColor,";\n          background: rgba(52, 152, 219, 0.05);\n        }\n        \n        .sbtcpay-wallet-button .wallet-icon {\n          width: 24px;\n          height: 24px;\n          border-radius: 4px;\n        }\n        \n        .sbtcpay-or-text {\n          text-align: center;\n          margin: 15px 0;\n          color: #666;\n          font-size: 14px;\n        }\n        \n        .sbtcpay-no-wallets {\n          text-align: center;\n          padding: 20px;\n          background: #f8f9fa;\n          border-radius: ").concat(this.options.theme.borderRadius,";\n          margin: 20px 0;\n        }\n        \n        .sbtcpay-wallet-recommendations {\n          display: flex;\n          flex-direction: column;\n          gap: 8px;\n          margin-top: 15px;\n        }\n        \n        .sbtcpay-wallet-recommendations a {\n          color: ").concat(this.options.theme.primaryColor,";\n          text-decoration: none;\n          font-weight: 500;\n        }\n        \n        .sbtcpay-wallet-recommendations a:hover {\n          text-decoration: underline;\n        }\n        \n        /* Connected Wallet Styles */\n        .sbtcpay-connected-wallet {\n          margin: 20px 0;\n        }\n        \n        .sbtcpay-wallet-info {\n          background: #f8f9fa;\n          padding: 12px 16px;\n          border-radius: ").concat(this.options.theme.borderRadius,";\n          margin-bottom: 15px;\n        }\n        \n        .sbtcpay-wallet-info .wallet-name {\n          display: block;\n          font-weight: 600;\n          color: ").concat(this.options.theme.textColor,";\n          margin-bottom: 4px;\n        }\n        \n        .sbtcpay-wallet-info .wallet-address {\n          display: block;\n          font-family: monospace;\n          font-size: 12px;\n          color: #666;\n        }\n          margin-bottom: 20px;\n        }\n        \n        .sbtcpay-widget-amount,\n        .sbtcpay-widget-description {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 10px;\n        }\n        \n        .sbtcpay-widget-amount .label,\n        .sbtcpay-widget-description .label {\n          font-weight: 600;\n        }\n        \n        .sbtcpay-widget-actions {\n          text-align: center;\n          margin-bottom: 20px;\n        }\n        \n        .sbtcpay-button {\n          background-color: ").concat(this.options.theme.primaryColor,";\n          color: white;\n          border: none;\n          padding: 12px 20px;\n          font-size: 16px;\n          border-radius: 4px;\n          cursor: pointer;\n          width: 100%;\n          font-weight: 600;\n          transition: background-color 0.3s;\n        }\n        \n        .sbtcpay-button:hover {\n          opacity: 0.9;\n        }\n        \n        .sbtcpay-button:focus {\n          outline: 2px solid ").concat(this.options.theme.primaryColor,";\n          outline-offset: 2px;\n        }\n        \n        .sbtcpay-widget-qrcode {\n          display: none;\n          text-align: center;\n          padding: 15px;\n          background: #f8f9fa;\n          border-radius: 4px;\n          margin-bottom: 20px;\n        }\n        \n        .sbtcpay-qr-info {\n          margin-top: 15px;\n        }\n        \n        .sbtcpay-qr-placeholder {\n          font-size: 14px;\n        }\n        \n        .sbtcpay-address {\n          font-family: monospace;\n          font-size: 12px;\n          word-break: break-all;\n          background: #eee;\n          padding: 5px;\n          border-radius: 3px;\n          margin: 5px 0;\n        }\n        \n        .sbtcpay-widget-success,\n        .sbtcpay-widget-error {\n          text-align: center;\n        }\n        \n        .sbtcpay-widget-success h3,\n        .sbtcpay-widget-error h3 {\n          margin-top: 0;\n        }\n        \n        .sbtcpay-widget-footer {\n          text-align: center;\n          font-size: 0.8em;\n          color: #7f8c8d;\n          border-top: 1px solid #ecf0f1;\n          padding-top: 15px;\n          margin-top: 15px;\n        }\n        \n        .sbtcpay-widget-error-content {\n          background: #f8d7da;\n          color: #721c24;\n          border: 1px solid #f5c6cb;\n          border-radius: 4px;\n          padding: 15px;\n          margin: 10px;\n        }\n        \n        /* Focus styles for accessibility */\n        .sbtcpay-button:focus,\n        .sbtcpay-widget a:focus {\n          outline: 2px solid ").concat(this.options.theme.primaryColor,";\n          outline-offset: 2px;\n        }\n      </style>\n    ");document.head.insertAdjacentHTML("beforeend",t)}}}],n&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,o,a,i,c,d,p,u,y,h,f,b}();document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('script[src*="widget.js"]').forEach(function(t){var n=t.getAttribute("data-api-key"),e=t.getAttribute("data-payment-intent-id"),o=t.getAttribute("data-container"),a=t.getAttribute("data-primary-color"),r=t.getAttribute("data-background-color"),i=t.getAttribute("data-text-color"),s=t.getAttribute("data-font-family"),c=t.getAttribute("data-border-radius"),l=t.getAttribute("data-logo-url");e&&new p({apiKey:n,paymentIntentId:e,container:o,theme:{primaryColor:a,backgroundColor:r,textColor:i,fontFamily:s,borderRadius:c,logoUrl:l}})})}),t.exports?t.exports=p:"undefined"!=typeof window&&(window.SBTCPayWidget=p)}},n={},function e(o){var a=n[o];if(void 0!==a)return a.exports;var r=n[o]={exports:{}};return t[o](r,r.exports,e),r.exports}(592);var t,n});