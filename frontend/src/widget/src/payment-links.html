<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sBTCPay Payment Links</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 30px;
        }
        h1, h2 {
            color: #2c3e50;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        input, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            box-sizing: border-box;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #e8f4fc;
            border-radius: 4px;
            display: none;
        }
        .qr-code {
            text-align: center;
            margin: 20px 0;
        }
        .qr-code img {
            max-width: 200px;
        }
        .link-display {
            word-break: break-all;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>sBTCPay Payment Links Generator</h1>
        <p>Create payment links that you can share with customers to collect sBTC payments.</p>
        
        <form id="payment-link-form">
            <div class="form-group">
                <label for="amount">Amount (sBTC)</label>
                <input type="number" id="amount" step="0.000001" required>
            </div>
            
            <div class="form-group">
                <label for="description">Description</label>
                <input type="text" id="description" placeholder="Payment for..." required>
            </div>
            
            <div class="form-group">
                <label for="expiresAt">Expiration Date (optional)</label>
                <input type="datetime-local" id="expiresAt">
            </div>
            
            <div class="form-group">
                <label for="password">Password Protection (optional)</label>
                <input type="password" id="password" placeholder="Leave blank for no password">
            </div>
            
            <div class="form-group">
                <label for="metadata">Metadata (optional, JSON format)</label>
                <textarea id="metadata" rows="4" placeholder='{"order_id": "12345", "customer_name": "John Doe"}'></textarea>
            </div>
            
            <button type="submit">Generate Payment Link</button>
        </form>
        
        <div id="result" class="result">
            <h3>Payment Link Generated</h3>
            <div class="qr-code">
                <img id="qr-code-image" alt="QR Code for payment link">
            </div>
            <p>Share this link with your customer:</p>
            <div class="link-display">
                <a id="payment-link" target="_blank"></a>
            </div>
            <button id="copy-link">Copy Link</button>
        </div>
    </div>

    <script src="./widget.js"></script>
    <script>
      // Check if SBTCPayWidget is available on the window object
      if (typeof window.SBTCPayWidget === 'undefined') {
        console.error('SBTCPayWidget is not available on the window object');
      } else {
        console.log('SBTCPayWidget is available on the window object');
      }

      // Delay widget creation to ensure script is fully loaded
      document.addEventListener('DOMContentLoaded', function() {
        // Create a basic widget
        setTimeout(() => {
          if (typeof window.SBTCPayWidget !== 'undefined') {
            new window.SBTCPayWidget({
              apiKey: 'test_api_key',
              paymentIntentId: 'pi_test123',
              container: '#widget-container-1'
            });
          } else {
            console.error('SBTCPayWidget is still not available');
          }
        }, 100);

        // Create a customized widget
        setTimeout(() => {
          if (typeof window.SBTCPayWidget !== 'undefined') {
            new window.SBTCPayWidget({
              apiKey: 'test_api_key',
              paymentIntentId: 'pi_test123',
              container: '#widget-container-2',
              theme: {
                primaryColor: '#8e44ad',
                backgroundColor: '#f9f9f9',
                textColor: '#2c3e50',
                fontFamily: '"Helvetica Neue", Helvetica, Arial, sans-serif',
                borderRadius: '12px',
                logoUrl: 'https://placehold.co/100x50/8e44ad/ffffff?text=Logo'
              }
            });
          } else {
            console.error('SBTCPayWidget is still not available');
          }
        }, 200);
      });
    </script>
</body>
</html>